# DOORHAN - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –∏ —Å–∞–π—Ç

–ü—Ä–æ–µ–∫—Ç –Ω–∞ Next.js 15 —Å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å—é –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```env
DATABASE_URL="file:./dev.db"
NEXTAUTH_SECRET="your-secret-key-change-in-production"
NEXTAUTH_URL="http://localhost:3000"
NEXT_PUBLIC_BASE_URL="http://localhost:3000"
TELEGRAM_BOT_TOKEN="your_telegram_bot_token"
TELEGRAM_CHAT_ID="your_telegram_chat_id"
```

2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
npm run db:push
```

3. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
npx tsx scripts/create-admin-user.ts admin@doorhan.com admin123
```

4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
npm run db:import
```

### –ó–∞–ø—É—Å–∫

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev

# Production —Å–±–æ—Ä–∫–∞
npm run build
npm start
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
doorhan_new/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ admin/             # –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ posts/             # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ components/        # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ prisma/                # Prisma —Å—Ö–µ–º–∞ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ public/                # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ images/           # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ scripts/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ create-admin-user.ts
‚îÇ   ‚îú‚îÄ‚îÄ import-data.ts
‚îÇ   ‚îú‚îÄ‚îÄ build-safe.sh      # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
‚îÇ   ‚îú‚îÄ‚îÄ deploy-full.sh     # –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π (—Å node_modules)
‚îÇ   ‚îú‚îÄ‚îÄ deploy-safe.sh     # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–µ–ø–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ setup-nginx-ssl.sh # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx –∏ SSL
‚îÇ   ‚îî‚îÄ‚îÄ setup-swap.sh      # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ swap –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
‚îî‚îÄ‚îÄ data/                 # –î–∞–Ω–Ω—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
```

## üîê –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

–î–æ—Å—Ç—É–ø: `http://localhost:3000/admin/login`

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞–º–∏ –∏ —Å–≤—è–∑—è–º–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–æ–º —Ñ–æ—Ç–æ
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PDF —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev

# –°–±–æ—Ä–∫–∞
npm run build              # –û–±—ã—á–Ω–∞—è —Å–±–æ—Ä–∫–∞
npm run build:safe        # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–±–æ—Ä–∫–∞ (–º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏)
npm run build:minimal     # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ (—ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏)

# –ó–∞–ø—É—Å–∫ production
npm start
npm run start:prod        # –ù–∞ –ø–æ—Ä—Ç—É 2231

# –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
npm run db:push          # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã
npm run db:migrate        # –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npm run db:import         # –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
```

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Next.js 15** - React —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **TypeScript** - –¢–∏–ø–∏–∑–∞—Ü–∏—è
- **Prisma** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **NextAuth** - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Tailwind CSS** - –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **SQLite** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## üîß –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–ü—Ä–æ–µ–∫—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏ –∏ —Ä–∞–±–æ—Ç—ã:
- ‚úÖ Tree-shaking –¥–ª—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ Code splitting –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (WebP, AVIF)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ console.log –≤ production
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å–∂–∞—Ç–∏–µ
- ‚úÖ ISR (Incremental Static Regeneration)
- ‚úÖ Lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é

## üöÄ –î–µ–ø–ª–æ–π

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.deploy` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.deploy.example`:
```bash
cp .env.deploy.example .env.deploy
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.deploy –∏ —É–∫–∞–∂–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞
```

2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
source .env.deploy
```

### –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–µ–ø–ª–æ—è

#### 1. –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞)
```bash
./scripts/deploy-full.sh
```
–ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤–∫–ª—é—á–∞—è `node_modules` –∏ `.next`.

#### 2. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–µ–ø–ª–æ–π (—Ç–æ–ª—å–∫–æ –∫–æ–¥, —Å–±–æ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
```bash
./scripts/deploy-safe.sh
```
–ö–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–¥, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å–±–æ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx –∏ SSL
```bash
./scripts/setup-nginx-ssl.sh
```
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç nginx –∏ –ø–æ–ª—É—á–∞–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt.

#### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ swap (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é)
```bash
./scripts/setup-swap-simple.sh
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

1. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
```bash
rsync -avz --exclude 'node_modules' --exclude '.next' --exclude '.env*' \
  --exclude '.git' --exclude '*.log' --exclude '.DS_Store' \
  --exclude 'prisma/dev.db*' --exclude 'data/import/*.json' \
  --exclude 'public/uploads/*' --exclude 'public/pdf/*.pdf' \
  ./ root@SERVER:/var/www/doorhan-mega/
```

2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É:**
```bash
ssh root@SERVER
cd /var/www/doorhan-mega
```

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å–±–æ—Ä–∫–∞:**
```bash
npm ci
npx prisma generate
npx prisma migrate deploy || npx prisma db push
npm run build
pm2 start ecosystem.config.js
pm2 save
```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
pm2 status
pm2 logs doorhan-mega
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É **2231**.

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:

1. **–£–¥–∞–ª–µ–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥ –ø–∞—Ä–æ–ª–∏** - –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. **–£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã** - –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ
3. **–û–±–Ω–æ–≤–ª–µ–Ω .gitignore** - –∏—Å–∫–ª—é—á–µ–Ω—ã –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –∏ –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã
4. **–°–æ–∑–¥–∞–Ω .env.deploy.example** - —à–∞–±–ª–æ–Ω –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–µ–ø–ª–æ—è

### –ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º –≤ Git:

- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –ø–∞—Ä–æ–ª–µ–π –≤ –∫–æ–¥–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `.env*` —Ñ–∞–π–ª—ã –≤ `.gitignore`
- ‚úÖ –£–¥–∞–ª–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–º–º–∏—Ç–∞—Ö

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏:**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–∏–º–∏—Ç—ã –ø–∞–º—è—Ç–∏ –¥–ª—è Node.js
   - –û—Ç–∫–ª—é—á–µ–Ω ESLint –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏
   - –£–º–µ–Ω—å—à–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º —Å–±–æ—Ä–∫–∏
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å–±–æ—Ä–∫–∏

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
   - –£–±—Ä–∞–Ω—ã –≤–ª–æ–∂–µ–Ω–Ω—ã–µ `<a>` —Ç–µ–≥–∏ (hydration error)
   - –£–±—Ä–∞–Ω—ã 404 –¥–ª—è `/sw.js`
   - –î–æ–±–∞–≤–ª–µ–Ω ISR (revalidate: 60)
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (lazy loading)

3. **–î–µ–ø–ª–æ–π:**
   - –°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω nginx —Å SSL
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω PM2 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ swap –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Ö–∞—Ä–¥–∫–æ–¥ –ø–∞—Ä–æ–ª–∏
   - –ü–∞—Ä–æ–ª–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
   - –û—á–∏—â–µ–Ω—ã –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

Private
